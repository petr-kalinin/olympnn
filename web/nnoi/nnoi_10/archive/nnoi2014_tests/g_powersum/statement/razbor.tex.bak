\input{powersum.tex}

\solution

Эту задачу можно решать разными способами, опишем один из них.

Разобьем все слагаемые в $S_{nk}$ на четные и нечетные. Рассмотрим сумму четных слагаемых. Выделив в каждом слагаемом явно множитель 2, сведем эту сумму к более простой задаче:
$$
2^k+4^k+\ldots=2^k\cdot(1^k+2^k+\ldots)=2^k\cdot S_{\left\lfloor {n\over 2}\right\rfloor,k},
$$
где $\lfloor x\rfloor$ обозначает целую часть $x$.

Сумму нечетных слагаемых преобразуем чуть более сложно. А именно, разложим каждое слагаемое $(2p+1)^k$ по формуле бинома Ньютона:
$$
(2p+1)^k=(2p)^k+C_k^1\cdot(2p)^{k-1} + C_k^2 \cdot (2p)^{k-2}+ \ldots + C_k^{k-1}\cdot 2p + 1;
$$
здесь $C_n^m$ "--- число сочетаний из $n$ по $m$ (биномиальный коэффициент).

Сумма всех таких слагаемых теперь вычисляется легко. Обозначая для сокращения записи $x=\lfloor(n-1)/2\rfloor$ "--- максимальное значение $p$ при данном $n$, "--- имеем:
$$
1^k+3^k+5^k+\ldots+(2x+1)^k=2^k\cdot S_{xk} + C_k^1\cdot 2^{k-1} S_{x,k-1} + \ldots + C_k^{k-1} \cdot2 S_{x,1} + x.
$$
Эти две формулы позволяют легко свести задачу с данными $n$ и $k$ к нескольким задачам с меньшими параметрам. Эти задачи также можно свести к еще более мелким и т.д., т.е. можно написать рекурсивный алгоритм, который будет решать задачу. Для получения полного решения необходимо еще учесть, что среди тех задач, которые такой алгоритм будет решать, будет много повторяющихся, поэтому надо запоминать уже решенные задачи и не решать одну и ту же задачу два раза. Естественно, все вычисления следует производить по модулю $m$.

Отметим также, что в этой задаче можно было написать частичные решения. Во-первых, при маленьком $n$ можно было требуемую сумму посчитать простым циклом. Во-вторых, при достаточно маленьком $m$ можно было воспользоваться тем, что у чисел, различающихся на $m$, остатки степеней по модулю совпадают: $(i+m)^k$ и $i^k$ имеют одинаковый остаток по модулю $m$ для любых $i$ и $k$. Поэтому при маленьких $m$ можно было вычислить только первые $m$ слагаемых суммы, а дальше использовать периодичность.

\input{code.tex}  